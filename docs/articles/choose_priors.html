<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Choose priors • aphidreps</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Choose priors">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aphidreps</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/choose_priors.html">Choose priors</a>
    </li>
    <li>
      <a href="../articles/estimate_pars.html">Estimating aphid population parameters</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lucasnell/aphid_repetition">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Choose priors</h1>
                        <h4 class="author">Lucas A. Nell</h4>
            
            <h4 class="date">2018-07-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/lucasnell/aphid_repetition/blob/master/vignettes/choose_priors.Rmd"><code>vignettes/choose_priors.Rmd</code></a></small>
      <div class="hidden name"><code>choose_priors.Rmd</code></div>

    </div>

    
    
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>Below is the model I’m fitting:</p>
<p><span class="math display">\[
X_{t+1} = X_t + R_0 \left( 1 - \alpha ~ \text{e}^{X_t} \right)
\]</span></p>
<p>where <span class="math inline">\(X_t\)</span> is log aphid counts for a particular plant at time <span class="math inline">\(t\)</span>, <span class="math inline">\(R_0\)</span> is the aphid line’s growth rate, and <span class="math inline">\(\alpha\)</span> is the line’s density dependence. Growth rates get one parameter for each aphid line. Density dependence, however, gets both mean and standard deviation estimates per aphid line, plus an overall <span class="math inline">\(\alpha\)</span> estimate per time-series, as a sort of random effect.</p>
<blockquote>
<p>Note that all parameters below are truncated to be &gt; 0.</p>
</blockquote>
</div>
<div id="growth-rates" class="section level2">
<h2 class="hasAnchor">
<a href="#growth-rates" class="anchor"></a>Growth rates</h2>
<p>From data sent to me from A.R. Ives related to this paper:</p>
<p>Meisner, M. H., J. P. Harmon, and A. R. Ives. 2014. Temperature effects on long-term population dynamics in a parasitoid–host system. <em>Ecological Monographs</em> <strong>84</strong>:457–476.</p>
<p>For fecundity, juvenile survival, and adult survival, the dataset had low and high estimates. I created two Leslie matrices, one with all of the high estimates and another with all the lower estimates. For each of these Leslie matrices, I estimated the intrinsic daily rate of increase (<span class="math inline">\(r\)</span>) in aphid populations in the lab as <span class="math inline">\(r = \log(\lambda)\)</span>, where <span class="math inline">\(\lambda\)</span> is the dominant eigenvector of the matrix. Thus I have fast and slow estimates of population growth, and from these I estimated the mean and standard deviation of the population-growth parameter. If the clonal lines from Meisner et al. (2014) are representative of the lines we currently have, and if these Leslie matrices truly represent the edges of possible <span class="math inline">\(r\)</span> values, then this standard deviation should be an upper estimate. The SE of <span class="math inline">\(r\)</span> is what I’ll use for the standard deviation of the mean.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">fast &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data-raw/leslie_fast.csv"</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">                 <span class="dt">col_types =</span> <span class="kw">cols</span>(<span class="dt">.default =</span> <span class="kw">col_double</span>())) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="st">    </span><span class="kw">as.matrix</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="st">    </span><span class="kw">eigen</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="st">    </span>.[[<span class="st">"values"</span>]] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="st">    </span>.[<span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="st">    </span><span class="kw">Re</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="st">    </span><span class="kw">log</span>()</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">slow &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data-raw/leslie_slow.csv"</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">                 <span class="dt">col_types =</span> <span class="kw">cols</span>(<span class="dt">.default =</span> <span class="kw">col_double</span>())) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="st">    </span><span class="kw">as.matrix</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="st">    </span><span class="kw">eigen</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="st">    </span>.[[<span class="st">"values"</span>]] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="st">    </span>.[<span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="st">    </span><span class="kw">Re</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="st">    </span><span class="kw">log</span>()</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">fast; slow</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="co">#&gt; [1] 0.2863108</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt; [1] 0.2559663</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="kw">mean</span>(<span class="kw">c</span>(fast, slow)); <span class="kw">sd</span>(<span class="kw">c</span>(fast, slow))</a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; [1] 0.2711385</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt; [1] 0.02145683</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="kw">sd</span>(<span class="kw">c</span>(fast, slow)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; [1] 0.01517227</span></a></code></pre></div>
<p>The cauchy distribution with scale = 0.005 seems about right for sampling the among-line SD.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/compare_priors.html">compare_priors</a></span>(<span class="kw">sd</span>(<span class="kw">c</span>(fast, slow)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>), <span class="fl">0.005</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.05</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">sd</span>(<span class="kw">c</span>(fast, slow)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span>))</a></code></pre></div>
<p><img src="choose_priors_files/figure-html/R0_sd_plot-1.svg" width="576"></p>
</div>
<div id="density-dependence" class="section level2">
<h2 class="hasAnchor">
<a href="#density-dependence" class="anchor"></a>Density dependence</h2>
<div id="among-line-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#among-line-distribution" class="anchor"></a>Among-line distribution</h3>
<p>Because Meisner et al. (2014) used cages of 8 plants, I’m setting my mean for <span class="math inline">\(\alpha\)</span> by multiplying their density-dependence estimate (<span class="math inline">\(0.000467\)</span>) by 8: <span class="math inline">\(\bar\alpha = 0.000467 \times 8 = 0.003736\)</span>.</p>
<p>They parameterized their density dependence slightly differently from the model I’m using, so I’m setting the standard deviation for <span class="math inline">\(\alpha\)</span> to be fairly wide. So for the distribution of mean alpha among all lines, the normal curve below looks good to me.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/compare_priors.html">compare_priors</a></span>(<span class="fl">0.003736</span>, <span class="fl">0.0015</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.003736</span>)</a></code></pre></div>
<p><img src="choose_priors_files/figure-html/alpha_overall_mean_plot-1.svg" width="576"></p>
<p>For sampling mean alphas for each line, I think a scale of 0.0015 is still fine, but I’ll use the cauchy distribution because of its heavier tails.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/compare_priors.html">compare_priors</a></span>(<span class="fl">0.003736</span>, <span class="fl">0.0015</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.01</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.003736</span>)</a></code></pre></div>
<p><img src="choose_priors_files/figure-html/alpha_line_means_plot-1.svg" width="576"></p>
<p>For the among-line SD distribution, I used a cauchy distribution with location = 0.0015 and scale = 0.0005 because it looks most reasonable to me.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/compare_priors.html">compare_priors</a></span>(<span class="fl">0.0015</span>, <span class="fl">0.0005</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.005</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.0015</span>)</a></code></pre></div>
<p><img src="choose_priors_files/figure-html/alpha_among_line_sd_plot-1.svg" width="576"></p>
</div>
<div id="within-line-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#within-line-distribution" class="anchor"></a>Within-line distribution</h3>
<p>I’m really not sure about the degree to which different plants will affect the density dependence within an aphid line. I’ll use some raw data from Meisner et al. (2014) to get some idea. Below is from their cage experiments when they added parasitoid wasps after aphid densities were allowed to peak (35 days). I didn’t use these estimates for mean alpha because of the potential effect of wasps, but this is probably as good an estimate of variance among plants that I’ll get. Notice that I’m dividing the max number of aphids by 8 because there were 8 plants in this experiment.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">read_csv</span>(<span class="st">"data-raw/MeisnerLongtermCageData.csv"</span>,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">         <span class="dt">col_types =</span> <span class="st">"iiiiii"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">    </span><span class="kw">filter</span>(treatment <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, year <span class="op">==</span><span class="st"> </span><span class="dv">2009</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">    </span><span class="kw">group_by</span>(replicate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">alpha =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(aphids <span class="op">/</span><span class="st"> </span><span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">    </span><span class="kw">select</span>(alpha) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">sd =</span> <span class="kw">sd</span>(alpha)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="st">    </span><span class="kw">unlist</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="st">    </span><span class="kw">signif</span>(<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;      sd </span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; 0.00142</span></a></code></pre></div>
<p>I’m choosing a cauchy distribution with location of 0.00142 and scale of 0.02 because I’m pretty uncertain of this parameter.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/compare_priors.html">compare_priors</a></span>(<span class="fl">0.00142</span>, <span class="fl">0.02</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.00142</span>)</a></code></pre></div>
<p><img src="choose_priors_files/figure-html/alpha_within_line_sd_plot-1.svg" width="576"></p>
</div>
</div>
<div id="process-error" class="section level2">
<h2 class="hasAnchor">
<a href="#process-error" class="anchor"></a>Process error</h2>
<p>I’m not really sure what this should be, but based on simulations, a value of 1 would be very high. Thus I chose a cauchy distribution with 0.1 as the location and scale because this appears about right.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/compare_priors.html">compare_priors</a></span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="fl">0.1</span>)</a></code></pre></div>
<p><img src="choose_priors_files/figure-html/process_error_plot-1.svg" width="576"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#model">Model</a></li>
      <li><a href="#growth-rates">Growth rates</a></li>
      <li><a href="#density-dependence">Density dependence</a></li>
      <li><a href="#process-error">Process error</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Lucas A. Nell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
